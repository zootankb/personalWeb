{% extends 'photoWeb/base.html' %}

{% load static %}

{% block main_data %}

    <div class="page-heading">
        <div class="container">
            <div class="heading-content">
                <h1>关于我们的 <em>日志</em></h1>
            </div>
        </div>
    </div>


    <div class="blog-entries">
        <div class="container">
            <div class="col-md-9">
                <div class="blog-posts">
                    <div class="row">
                        <!--
                        <div class="col-md-12">
                            <div class="blog-post">
                                <img src="{% static 'photoWeb/img/blog_post_1.png' %}" alt="">
                                <div class="text-content">
                                    <span><a href="#">Admin</a> / <a href="#">16 September 2018</a> / <a href="#">Branding</a></span>
                                    <h2>Duis mollis orci vel lectus</h2>
                                    <p>Proin at augue quam. In laoreet arcu id lacus fringilla auctor. Etiam rutrum
                                        aliquet nisl, eu fermentum elit fermentum sed. Donec finibus urna sed
                                        sollicitudin egestas. In hac habitasse platea dictumst.
                                        <br><br>Phasellus purus turpis, porta non lectus vitae, laoreet blandit diam.
                                        Suspendisse elementum ligula at purus gravida, vel malesuada dolor accumsan.
                                        Morbi finibus dapibus ex, ut finibus felis.</p>
                                    <div class="simple-btn">
                                        <a href="{% url "photoWeb:single_post" %}">continue reading</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="blog-post">
                                <img src="{% static 'photoWeb/img/blog_post_2.png' %}" alt="">
                                <div class="text-content">
                                    <span><a href="#">Admin</a> / <a href="#">28 August 2018</a> / <a
                                            href="#">Lifestyle</a></span>
                                    <h2>Integer scelerisque odio elit</h2>
                                    <p>Aliquam erat volutpat. Donec condimentum ante nec sapien sodales, ut molestie
                                        mauris scelerisque. Maecenas in turpis sed odio pretium tempor. In libero
                                        tellus, maximus in accumsan id, posuere non urna.
                                        <br><br>Fusce ex elit, congue vitae interdum et, sodales vitae purus. Vestibulum
                                        ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae;
                                        Quisque id egestas nibh. Curabitur convallis cursus pharetra. Curabitur non
                                        ligula id lacus pulvinar sollicitudin. Etiam quis tempus lectus, sed iaculis ex.
                                    </p>
                                    <div class="simple-btn">
                                        <a href="{% url "photoWeb:single_post" %}">continue reading</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="blog-post">
                                <img src="{% static 'photoWeb/img/blog_post_3.png' %}" alt="">
                                <div class="text-content">
                                    <span><a href="#">Admin</a> / <a href="#">31 July 2018</a> / <a
                                            href="#">Work Stuff</a></span>
                                    <h2>Nulla condimentum at dui eu</h2>
                                    <p>Cras ultrices ex sodales, vestibulum leo quis, volutpat mauris. In pretium
                                        vehicula dolor, sit amet ornare orci placerat sit amet. Nam non dolor sagittis,
                                        dignissim purus at, fringilla lacus. In aliquet, sapien ut lobortis molestie,
                                        lorem diam commodo leo, vitae eleifend diam justo ac velit.
                                        <br><br>ras felis purus, efficitur vel luctus a, ultrices vitae diam. Maecenas
                                        maximus vehicula aliquet. Donec scelerisque, diam id dapibus ultrices, tortor
                                        tellus eleifend arcu, maximus iaculis mi elit sit amet odio. Donec at mauris sit
                                        amet velit tempus semper.</p>
                                    <div class="simple-btn">
                                        <a href="{% url "photoWeb:single_post" %}">continue reading</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        -->
                        {% if data %}
                            {% for d in data.blogs %}
                                <div class="col-md-12">
                                    <div class="blog-post">
                                        <img src="{{ MEDIA_URL }}{{ d.imgLevel1 }}" alt="">
                                        <div class="text-content">
                                    <span><a href="#">{{ d.cameraman }}</a> / <a href="#">{{ d.created_at }}</a> / <a
                                            href="#">{{ d.category }}</a></span>
                                            <h2>{{ d.title }}</h2>
                                            <p>{{ d.content }}</p>
                                            <div class="simple-btn">
                                                <a id="{{ d.id }}"
                                                   href="{% url "photoWeb:single_post" %}?id={{ d.id }}">continue
                                                    reading</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}

                    </div>
                </div>
                <div class="col-md-12">
                    <div class="grid-portfolio" id="portfolio">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="load-more-button" onclick="loadmore()">
                                        <a href="#">加载更多</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--
                                                <ul class="page-number">
                                                    <li class="active"><a href="#">1</a></li>
                                                    <li><a href="#">2</a></li>
                                                    <li><a href="#">3</a></li>
                                                    <li><a href="#">></a></li>
                                                </ul>
                                                -->
                </div>
            </div>
            <div class="col-md-3">
                <div class="side-bar">
                    <div class="search">
                        <fieldset>
                            <input name="search" type="text" class="form-control" id="search" placeholder="Search..."
                                   required="">
                        </fieldset>
                    </div>
                    <div class="archives">
                        <div class="sidebar-heding">
                            <h2>归档</h2>
                        </div>
                        <ul>
                            <li><a href="#">> 2018 September (4)</a></li>
                            <li><a href="#">> 2018 August (16)</a></li>
                            <li><a href="#">> 2018 July (5)</a></li>
                            <li><a href="#">> 2018 May (3)</a></li>
                            <li><a href="#">> 2018 February (27)</a></li>
                            <li><a href="#">> 2017 December (18)</a></li>
                            <li><a href="#">> 2017 November (12)</a></li>
                        </ul>
                    </div>
                    <div class="recent-posts">
                        <div class="sidebar-heding">
                            <h2>最近上传</h2>
                        </div>
                        <ul>
                            <!--
                            <li><a href="{% url "photoWeb:single_post" %}"/>
                                <img src="{% static 'photoWeb/img/recent_post_1.png' %}" alt="Recent Post 1">
                                <div class="text">
                                    <h6>Duis mollis orci</h6>
                                    <span>15 September 2018</span>
                                </div>
                            </li>
                            <li><a href="{% url "photoWeb:single_post" %}"/>
                                <img src="{% static 'photoWeb/img/recent_post_2.png' %}" alt="Recent Post 2">
                                <div class="text">
                                    <h6>Etiam quis tem</h6>
                                    <span>10 August 2018</span>
                                </div>
                            </li>
                            <li><a href="{% url "photoWeb:single_post" %}"/>
                                <img src="{% static 'photoWeb/img/recent_post_3.png' %}" alt="Recent Post 3">
                                <div class="text">
                                    <h6>Proin at augue</h6>
                                    <span>16 July 2018</span>
                                </div>
                            </li>
                            -->
                            {% if data %}
                                {% for cameraman in data.recent_cameraman %}
                                    <li><a href="{% url "photoWeb:single_post" %}?id={{ cameraman.id }}"/>
                                        <img src="{{ MEDIA_URL }}{{ cameraman.imgLevel2 }}" alt="Recent Post 3">
                                        <div class="text">
                                            <h6>{{ cameraman.cameraman }}</h6>
                                            <span>{{ cameraman.created_at }}</span>
                                        </div>
                                    </li>
                                {% endfor %}
                            {% endif %}
                        </ul>
                    </div>
                    <div class="categories">
                        <div class="sidebar-heding">
                            <h2>风格</h2>
                        </div>
                        <ul>

                            <!--
                            <li><a href="#">> Lifestyle (7)</a></li>
                            <li><a href="#">> Branding (9)</a></li>
                            <li><a href="#">> Nature (14)</a></li>
                            <li><a href="#">> Work Stuff (6)</a></li>
                            <li><a href="#">> Science (5)</a></li>
                            -->
                            {% if data %}
                                {% for c in data.categories %}
                                    <li><a href="#">> {{ c.category }}({{ c.num }})</a></li>
                                {% endfor %}
                            {% endif %}
                        </ul>
                    </div>
                    <div class="latest-gallery">
                        <div class="sidebar-heding">
                            <h2>最新图片</h2>
                        </div>
                        <ul>
                            <!--
                            <li><a href="#"></a><img src="{% static 'photoWeb/img/latest_gallery_1.png' %}" alt=""></li>
                            <li><a href="#"></a><img src="{% static 'photoWeb/img/latest_gallery_2.png' %}" alt=""></li>
                            <li><a href="#"></a><img src="{% static 'photoWeb/img/latest_gallery_3.png' %}" alt=""></li>
                            <li><a href="#"></a><img src="{% static 'photoWeb/img/latest_gallery_4.png' %}" alt=""></li>
                            <li><a href="#"></a><img src="{% static 'photoWeb/img/latest_gallery_5.png' %}" alt=""></li>
                            <li><a href="#"></a><img src="{% static 'photoWeb/img/latest_gallery_6.png' %}" alt=""></li>
                            <li><a href="#"></a><img src="{% static 'photoWeb/img/latest_gallery_7.png' %}" alt=""></li>
                            <li><a href="#"></a><img src="{% static 'photoWeb/img/latest_gallery_8.png' %}" alt=""></li>
                            -->
                            {% if data %}
                                {% for img in data.recent_imgs %}
                                    <li><a href="{% url 'photoWeb:single_post' %}?id={{ img.id }}"><img src="{{ MEDIA_URL }}{{ img.imgLevel3 }}" alt=""></a></li>
                                {% endfor %}
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var totalPage = 2;//总页数
        var pageNo = 1;//当前页数
        var pageSize = 3; // 页面大小
        function loadmore() {
            if (pageNo < totalPage) {
                pageNo++;
                getPageInfo(pageNo, pageSize);
            } else {
                alert("已经没有可撸的了");
            }
        }

        function getPageInfo(num, size) {
            $.ajax({
                url: "{% url 'photoWeb:get_blog_page' %}",
                type: "GET",
                data: {
                    pageNumber: num,
                    pageSize: size
                },
                dataType: "json",
                success: function (data) {
                    if (data != null) {
                        var jd = data;
                        totalPage = jd.totalPage;
                        var result = '';
                        for (var i = 0; i < jd.content.length; ++i) {
                            result += '<div class="col-md-12">\n' +
                                '                                    <div class="blog-post">\n' +
                                '                                        <img src="' + {{ MEDIA_URL }} +jd.content[i].imgLevel1 + '" alt="">\n' +
                                '                                        <div class="text-content">\n' +
                                '                                    <span><a href="#">' + jd.content[i].cameraman + '</a> / <a href="#">' + jd.content[i].created_at + '</a> / <a\n' +
                                '                                            href="#">' + jd.content[i].category + '</a></span>\n' +
                                '                                            <h2>' + jd.content[i].title + '</h2>\n' +
                                '                                            <p>' + jd.content[i].content + '</p>\n' +
                                '                                            <div class="simple-btn">\n' +
                                '                                                <a id="' + jd.content[i].id + '" href="{% url "photoWeb:single_post" %}?id=' + jd.content[i].id + '">continue reading</a>\n' +
                                '                                            </div>\n' +
                                '                                        </div>\n' +
                                '                                    </div>\n' +
                                '                                </div>';

                        }
                        $('.blog-posts').append(result);
                    }
                },
                error: function (request) {
                    alert(request.code);
                }
            })
        };
    </script>
{% endblock %}